---

title: "/home/anarendran/Documents/temp/rivet/analyses/pluginCDF/CDF_2005_S6217184.cc"

---

# /home/anarendran/Documents/temp/rivet/analyses/pluginCDF/CDF_2005_S6217184.cc



## Namespaces

| Name           |
| -------------- |
| **[Rivet](http://example.org/namespaces/namespacerivet/)** <br>-*- C++ -*-  |

## Classes

|                | Name           |
| -------------- | -------------- |
| class | **[Rivet::CDF_2005_S6217184](http://example.org/classes/classrivet_1_1cdf__2005__s6217184/)** <br>CDF Run II jet shape analysis.  |




## Source code

```cpp
// -*- C++ -*-
#include "Rivet/Analysis.hh"
#include "Rivet/Projections/FastJets.hh"
#include "Rivet/Projections/VetoedFinalState.hh"
#include "Rivet/Projections/VisibleFinalState.hh"
#include "Rivet/Projections/JetShape.hh"

namespace Rivet {


  class CDF_2005_S6217184 : public Analysis {
  public:

    RIVET_DEFAULT_ANALYSIS_CTOR(CDF_2005_S6217184);



    void init() {
      // Set up projections
      const FinalState fs(Cuts::abseta < 2);
      declare(fs, "FS");
      FastJets fj(fs, FastJets::CDFMIDPOINT, 0.7, JetAlg::Muons::ALL, JetAlg::Invisibles::ALL);
      declare(fj, "Jets");

      // Register a jet shape projection and histogram for each pT bin
      for (size_t i = 0; i < 6; ++i) {
        for (size_t j = 0; j < 3; ++j) {
          const size_t k = i*3 + j;
          stringstream ss; ss << "JetShape" << k;
          const string pname = ss.str();
          _jsnames_pT[k] = pname;
          const JetShape jsp(fj, 0.0, 0.7, 7, PTEDGES[k], PTEDGES[k+1], 0.1, 0.7, RAPIDITY);
          declare(jsp, pname);
          book(_profhistRho_pT[k] ,i+1, 1, j+1);
          book(_profhistPsi_pT[k] ,6+i+1, 1, j+1);
        }
      }

      // Final histo
      book(_profhistPsi_vs_pT, 13, 1, 1, true);
    }


    void analyze(const Event& evt) {

      // Get jets and require at least one to pass pT and y cuts
      const Jets jets = apply<FastJets>(evt, "Jets")
        .jetsByPt(Cuts::ptIn(PTEDGES.front()*GeV, PTEDGES.back()*GeV) && Cuts::absrap < 0.7);
      MSG_DEBUG("Jet multiplicity before cuts = " << jets.size());
      if (jets.size() == 0) {
        MSG_DEBUG("No jets found in required pT and rapidity range");
        vetoEvent;
      }

      // Calculate and histogram jet shapes
      for (size_t ipt = 0; ipt < 18; ++ipt) {
        const JetShape& jsipt = apply<JetShape>(evt, _jsnames_pT[ipt]);
        for (size_t ijet = 0; ijet < jsipt.numJets(); ++ijet) {
          for (size_t rbin = 0; rbin < jsipt.numBins(); ++rbin) {
            const double r_rho = jsipt.rBinMid(rbin);
            MSG_DEBUG(ipt << " " << rbin << " (" << r_rho << ") " << jsipt.diffJetShape(ijet, rbin));
            _profhistRho_pT[ipt]->fill(r_rho/0.7, (0.7/0.1)*jsipt.diffJetShape(ijet, rbin));
            const double r_Psi = jsipt.rBinMax(rbin);
            _profhistPsi_pT[ipt]->fill(r_Psi/0.7, jsipt.intJetShape(ijet, rbin));
          }
        }
      }

    }


    // Finalize
    void finalize() {
      // Construct final 1-Psi(0.3/0.7) profile from Psi profiles
      for (size_t i = 0; i < PTEDGES.size()-1; ++i) {
        // Get entry for rad_Psi = 0.2 bin
        ProfileBin1D& bi = _profhistPsi_pT[i]->bin(2);
        const double y  = (bi.effNumEntries() > 0) ? bi.mean() : 0;
        const double ey = (bi.effNumEntries() > 1) ? bi.stdErr() : 0;
        _profhistPsi_vs_pT->point(i).setY(y, ey);
      }
    }



  private:

    const array<double, 19> PTEDGES =
      {{ 37.0, 45.0, 55.0, 63.0, 73.0, 84.0, 97.0, 112.0, 128.0, 148.0,
         166.0, 186.0, 208.0, 229.0, 250.0, 277.0, 304.0, 340.0, 380.0 }};

    array<string, 18> _jsnames_pT;


    Profile1DPtr _profhistRho_pT[18];
    Profile1DPtr _profhistPsi_pT[18];
    Scatter2DPtr _profhistPsi_vs_pT;

  };



  RIVET_DECLARE_ALIASED_PLUGIN(CDF_2005_S6217184, CDF_2005_I682179);

}
```


-------------------------------

Updated on 2022-07-27 at 19:10:14 +0100
